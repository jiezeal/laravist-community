#ç¤¾åŒºè¯„è®º

php artisan make:migration create_comments_table --create=comments
php artisan make:model Comment

2017_03_06_151855_create_comments_table.php
```
public function up()
{
    Schema::create('comments', function (Blueprint $table) {
        $table->increments('id');
        $table->text('body');
        $table->integer('user_id')->unsigned();
        $table->integer('discussion_id')->unsigned();
        $table->foreign('user_id')
              ->references('id')
              ->on('users')
              ->onDelete('cascade');
        $table->foreign('discussion_id')
              ->references('id')
              ->on('discussions')
              ->onDelete('cascade');
        $table->timestamps();
    });
}
```

User.php
```
/**
 * @return \Illuminate\Database\Eloquent\Relations\HasMany
 */
public function comments(){
    return $this->hasMany(Comment::class);
}
```

Discussion.php
```
/**
 * @return \Illuminate\Database\Eloquent\Relations\HasMany
 */
public function comments(){
    return $this->hasMany(Comment::class);
}
```

Comment.php
```
protected $fillable = ['body', 'user_id', 'discussion_id'];

/**
 * @return \Illuminate\Database\Eloquent\Relations\BelongsTo
 */
public function user(){
    return $this->belongsTo(User::class);
}

/**
 * @return \Illuminate\Database\Eloquent\Relations\BelongsTo
 */
public function discussion(){
    return $this->belongsTo(Discussion::class);
}
```

php artisan migrate

ModelFactory.php
```
$factory->define(App\Comment::class, function (Faker\Generator $faker) {
    $user_ids = \App\User::pluck('id')->toArray();
    $discussion_ids = \App\Discussion::pluck('id')->toArray();

    return [
        'body' => $faker->paragraph,
        'user_id' => $faker->randomElement($user_ids),
        'discussion_id' => $faker->randomElement($discussion_ids),
    ];
});
```

php artisan tinker
namespace App;
factory(Comment::class, 100)->create();

